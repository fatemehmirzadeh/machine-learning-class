# Credit Card Fraud Detection - Machine learning methods
Credit Card Fraud Detection - Machine learning methods


<div dir="rtl">
روش‌های یادگیری ماشین testکارت اعتباری
</div>

<div dir="rtl">چکیده - تقلب در کارت اعتباری به از دست دادن فیزیکی کارت اعتباری یا از دست دادن اطلاعات حساس کارت اعتباری اشاره دارد. بسیاری از الگوریتم های دستیابی به ماشین‌آلات را می توان برای تشخیص مورد استفاده قرار داد. این تحقیق چندین الگوریتم را نشان می‌دهد که می‌توانند برای طبقه‌بندی معاملات به عنوان تقلب یا تقلب واقعی مورد استفاده قرار گیرند. مجموعه داده تشخیص تقلب کارت اعتباری در این تحقیق مورد استفاده قرار گرفت. از آنجا که مجموعه داده‌ها بسیار نامتعادل بودند، تکنیک SMOTE برای نمونه‌گیری بیش از حد مورد استفاده قرار گرفت. علاوه بر این، انتخاب ویژگی انجام شد و مجموعه داده‌ها به دو بخش داده‌های آموزشی و داده‌های تست تقسیم شدند. الگوریتم های مورد استفاده در این آزمایش عبارتند از رگرسیون لجستیک، جنگل تصادفی، نایو بیز و پرسپترون چند لایه . نتایج نشان می‌دهد که هر الگوریتم می‌تواند برای تشخیص تقلب کارت اعتباری با دقت بالا مورد استفاده قرار گیرد.  مدل پیشنهادی می‌تواند برای تشخیص دیگر بی‌نظمی‌ها مورد استفاده قرار گیرد.  
</div>
<br/>

<div dir="rtl">
کلمات کلیدی: کلاهبرداری؛ رگرسیون منطقی: Multilayer Perceptron؛ Naive Bayes؛ جنگل تصادفی؛ 
</div>  

<div dir="rtl">
  مقدمه 
  </div>
  <br/>
<div dir="rtl">
  تعداد رو به رشدی از شرکت‌های جدید در سراسر جهان وجود دارد [‏ ۱] ‏. تمام این شرکت‌ها در تلاش برای ارائه بهترین کیفیت خدمات به مشتریان خود هستند. به منظور موفقیت در این امر، شرکت‌ها داده‌های زیادی را به صورت روزانه پردازش می‌کنند. این داده‌ها از تعداد زیادی از منابع می‌آیند و در فرمت های مختلف هستند. علاوه بر این، این داده‌ها شامل برخی از بخش‌های کلیدی کسب‌وکار آینده شرکت است . به همین دلیل، شرکت‌ها باید آن داده‌ها را ذخیره کنند، آن را پردازش کنند و آنچه واقعا مهم است، تا آن را ایمن نگه دارند . بدون تامین امنیت داده‌ها، بسیاری از آن‌ها می‌توانند توسط شرکت‌های دیگر و یا حتی بدتر از آن مورد استفاده قرار گیرند، می‌توانند به سرقت برده شوند . در بیشتر موارد، اطلاعات مالی به سرقت می‌رود که می‌تواند به کل شرکت یا فرد آسیب برساند. 
  </div>
<br/>

<div dir="rtl">
میزان کلاهبرداری به طور نسبی یکسان است و یا به دلیل سیستم‌های تشخیص تقلب پیچیده کاهش‌یافته است. با این حال، کلاهبرداران به طور مداوم با روش‌های جدیدی برای سرقت اطلاعات مواجه می‌شوند. دو نوع کلاهبرداری کارت اعتباری وجود دارد. یکی سرقت کارت فیزیکی است، و دیگری سرقت اطلاعات حساس از کارت است، مانند شماره کارت، کد cvv، نوع کارت و غیره.
</div>
<br/>
<div dir="rtl">
با سرقت اطلاعات کارت اعتباری، کلاهبردار می‌تواند مقدار زیادی پول را به سرقت برده و یا قبل از این که صاحب کارت متوجه شود، مقدار زیادی خرید انجام دهد. به همین دلیل، شرکت‌ها از روش‌های مختلف یادگیری ماشین برای تشخیص اینکه کدام تراکنشها جعلی هستند و کدام نیستند، استفاده می‌کنند.
<div/>
<br/>  
<div dir="rtl">
نکته : هدف از این مقاله، تجزیه و تحلیل الگوریتم های مختلف یادگیری ماشین، مانند (رگرسیون لجستیک LR است). Random forest (RF) و Naïve bayes(NB) و (Mlp) به منظور اینکه کدام الگوریتم مناسب تر برای تشخیص تقلب است.
</div>

<div dir="rtl">
بقیه مقاله به صورت زیر ساختاربندی شده‌است: در بخش ۲ تحقیقاتی که با مساله مشخص‌شده سر و کار دارند ارائه می‌شوند، بخش ۳ شرح مختصری از مجموعه داده‌هایی که در آزمایش مورد استفاده قرار می‌گیرند را ارائه می‌دهد، که پس از آن نتایج در بخش ۴ ارائه می‌شوند.
در نهایت، نکات نتیجه‌گیری در بخش ۵ مورد بحث قرار گرفته و در ادامه لیستی از مقالات آورده شده‌است.
  </div>  
<br/>
<div dir="rtl">  
کارهای مرتبط
</div>  
<div dir="rtl">
فعالیت‌های کلاهبرداری باعث ضرر و زیان زیادی می‌شوند، که محققان را بر آن داشت تا راه حلی بیابند که بتواند کلاهبرداری‌ها را شناسایی کرده و از آن‌ها جلوگیری کند. تاکنون چندین روش پیشنهاد و آزمایش شده‌اند. برخی از آن‌ها به طور خلاصه در زیر مرور شده‌اند. الگوریتم های کلاسیک مانند بوت کردن گرادیان (‏GB)‏، ماشین بردار پشتیبان (‏SVM)‏، درخت تصمیم (‏DT)‏، LR و RF مفید بودن آن‌ها را اثبات کرده‌اند.  
</div>  
<br/>

<div dir="rtl">
در مقاله [‏ ۵ ]‏ GB، LR، RD، SVM و ترکیبی از طبقه‌بندی کننده‌های خاص استفاده شده‌است که منجر به فراخوانی بالای ۹۱ % در یک مجموعه دیتاست اروپایی شده‌است.  
</div>
  
<div dir="rtl">
دقت و یادآوری بالا تنها پس از متعادل کردن مجموعه داده با نمونه ‌برداری کم‌تر از داده‌ها حاصل شد. در مقاله [‏ ۶ ]‏، مجموعه داده اروپایی نیز مورد استفاده قرار گرفت و مقایسه‌ای بین مدل‌های مبتنی بر LR، DT و RF انجام شد.
در میان این سه مدل، RF با دقت ۹۵.۵ % بهترین و سپس DT با دقت ۹۴.۳ % و LR با دقت ۹۰ % بهترین بودند.
</div>  
<br/>  
<div dir="rtl">
با توجه به [‏ ۷ ]‏ و [‏ ۸ ]‏، نزدیک‌ترین همسایه‌ها (‏KNN) ‏و تکنیک‌های تشخیص داده‌های پرت نیز می‌توانند در تشخیص تقلب موثر باشند. ثابت شده‌است که آن‌ها در به حداقل رساندن نرخ هشدار اشتباه و افزایش نرخ تشخیص تقلب مفید هستند. الگوریتم KNN همچنین در آزمایش مقاله [‏ ۹ ]‏ به خوبی عمل کرد، که در آن نویسندگان آن را با دیگر الگوریتم های کلاسیک تست و مقایسه کردند. برخلاف مقالات ذکر شده تاکنون، در مقاله [‏ ۱۰ ]‏ مقایسه‌ای بین برخی از الگوریتم های کلاسیک و تکنیک‌های یادگیری عمیق انجام شده‌است.
</div>  
<br/>
<div dir="rtl">
تمام تکنیک‌های تست شده به دقت حدود ۸۰ % دست یافتند. نویسندگان مقاله [‏ ۱۱ ]‏، در کنار الگوریتم های زیر تنظیم شده‌اند: RF ، GB، LR، SVM، DT، KNN، NB، XGBoost‏XGB, ‏ ، MLPو طبقه‌بندی کننده دسته‌ای ‏ترکیبی از طبقه‌بندی کننده‌های یادگیری ماشین چندگانه، در حالی که از مجموعه داده‌های اروپایی استفاده می‌کنند
<br/>
<div dir="rtl">  
در نتیجه پیش‌پردازش کامل داده‌ها، تمام الگوریتم ها دقت بالای بیش از ۹۰ % را انجام دادند. طبقه‌بندی کننده توقف با دقت ۹۵ % و مقدار فراخوانی ۹۵ % موفق‌تر بود.
  </div>
  
<br/>  

<div dir="rtl">
در مقاله [‏ ۱۲ ]‏، یک شبکه عصبی بر روی مجموعه دیتاست اروپایی مورد آزمایش قرار گرفت. آزمایش شامل شبکه عصبی پس انتشار است که با الگوریتم وال گیری بهینه‌سازی شده‌است.
</div>  
  

<div dir="rtl">
شبکه عصبی از ۲ لایه ورودی، ۲۰ لایه پنهان و ۲ لایه خروجی تشکیل شده‌است. با توجه به الگوریتم بهینه‌سازی، آن‌ها به نتایج استثنایی در ۵۰۰ نمونه آزمون دست یافتند: دقت ۴۰ / ۹۶ % و فراخوانی ۸۳ / ۹۷ %.
</div>  

<div dir="rtl">
نویسندگان مقاله [‏ ۱۳ ]‏ و [‏ ۱۴ ]‏ از شبکه‌های عصبی به منظور نشان دادن بهبود در نتایج در هنگام استفاده از تکنیک‌های گروهی استفاده کرده‌اند.
</dir>
  
<div dir="rtl">
در مقاله [‏ ۱۵ ]‏ از سه مجموعه داده برای مقایسه بین الگوریتم های ماشین بولتزمن محدود و رمزگذار خودکار استفاده شد، که منجر به این نتیجه شد که الگوریتم هایی مانند MLP می‌توانند برای تشخیص تقلب کارت اعتباری مناسب باشند.
مقالات متعددی با استفاده از شبکه‌های عصبی عمیق بر روی تشخیص تراکنش های متقلبانه متمرکز شده‌اند.
</dir>
  
<div dir="rtl">
با این حال، این مدل‌ها از نظر محاسباتی گران بوده و در مجموعه داده‌های بزرگ‌تر بهتر عمل می‌کنند [‏ ۱۶ ]‏.
این رویکرد ممکن است به نتایج بزرگی منجر شود، همانطور که در برخی مقالات مشاهده کردیم، اما چه می‌شود اگر نتایج مشابه، یا حتی بهتر، را بتوان با مقدار کمتری از منابع به دست آورد؟
</div>  
<br/>
<div dir="rtl">
هدف اصلی ما این است که نشان دهیم الگوریتم های مختلف یادگیری ماشین می‌توانند نتایج مناسبی را با پیش‌پردازش مناسب ارایه دهند.
نویسندگان اکثر مقاله ذکر شده از تکنیک نمونه‌گیری کم‌تر استفاده کردند، و این انگیزه‌ای برای استفاده از یک روش نمونه‌گیری بیش از حد متفاوت بود.
</div>

<div dir="rtl">
با توجه به حقایق داده‌شده، نویسندگان این مقاله تصمیم به مقایسه مناسب بودن LR، RF، NB و MLP برای تشخیص تقلب کارت اعتباری گرفتند.
به منظور دستیابی به این هدف، آزمایشی انجام شد.
</div>  
<br/>  
           
<div dir="rtl">
A. دیتاست
</div>   
<div dir="rtl">
در این تحقیق از مجموعه داده تشخیص تقلب کارت اعتباری استفاده شده‌است که می‌تواند از کاگل دانلود شود.
این مجموعه داده شامل تراکنش هایی است که در دو روز گذشته توسط دارندگان سهام اروپایی در سپتامبر ۲۰۱۳ انجام شده‌است.
از آنجا که برخی از متغیرهای ورودی شامل اطلاعات مالی هستند، PCA
</div> 
</br>  
<div dir="rtl">
به منظور ناشناس نگه داشتن این داده‌ها، تبدیل این متغیرهای ورودی انجام شد. سه مورد از این ویژگی‌ها تبدیل نشدند. ویژگی "زمان" زمان بین اولین معامله و هر معامله دیگر در مجموعه داده را نشان می‌دهد. ویژگی "سوار شدن" مقدار تراکنش های انجام‌شده توسط کارت اعتباری است . ویژگی "رده" نشان‌دهنده برچسب است، و تنها ۲ ارزش می‌گیرد: ارزش ۱ در مورد معامله کلاهبرداری و در غیر این صورت ۰. 
</div>  
<br/>
<div dir="rtl"> 
B: پیش‌پردازش 
</div>
  
<div dir="rtl">
انتخاب ویژگی یک تکنیک اساسی است که متغیرهایی را انتخاب می‌کند که بیش‌ترین ارتباط را با مجموعه داده داده‌شده دارند. با انتخاب دقیق ویژگی‌های مناسب و حذف ویژگی‌های کم‌تر مهم می توان بیش از حد مناسب را کاهش داد، دقت را بهبود بخشید و زمان آموزش را کاهش داد. تکنیک‌های تصویرسازی می‌توانند در این فرآیند مفید باشند. ابزار انتخابگر ویژگی [‏ ۱۸ ]‏ توسط ویل کوهرسن در این آزمایش برای این منظور استفاده شد. با استفاده از این ابزار مشخص شده‌است که کدام ویژگی‌ها از همه مهم‌تر هستند. علاوه بر این، ویژگی‌هایی که به اهمیت تجمعی ۹۵ % کمک نمی‌کنند حذف شدند. پس از تکنیک انتخاب ویژگی، ۲۷ ویژگی برای آزمایش اضافی انتخاب شدند. 
</div>  

<div dir="rtl">
الگوریتم های یادگیری ماشینی در یادگیری مشکل دارند زمانی که دسته‌های طبقه‌بندی تقریبا به طور مساوی توزیع نشده اند. با توجه به این که داده‌های داده‌شده بسیار نامتعادل هستند، لازم است که نوعی تعادل ایجاد شود تا مدل بتواند به طور موثر آموزش داده شود. روش‌های متداول مورد استفاده برای تنظیم توزیع کلاس شامل نمونه‌گیری پایین از کلاس اکثریت، نمونه‌گیری بیش از حد از کلاس اقلیت یا ترکیبی از این دو می‌باشد. تکنیک نمونه‌گیری بیش از حد اقلیت ترکیبی (‏SMOTE)‏یک روش نمونه‌گیری بیش از حد معروف است که زمانی که بر روی مجموعه داده‌های نامتعادل استفاده می‌شود، مفید واقع می‌شود [‏ ۱۹ ]‏، [‏ ۲۰ ]‏. روش SMOTE برای بهبود نمونه‌برداری بیش از حد تصادفی پیشنهاد شد (‏شکل ۱)‏. 
</div>  

  
![t2](https://github.com/semnan-university-ai/machine-learning-class/blob/main/presentation/Homayontoosy/6.jpg)  
  
<div dir="rtl">
بسیاری از الگوریتم های یادگیری ماشین انتظار مقیاس ورودی را دارند . با در نظر گرفتن این که مقادیر زمان و مقدار بسیار متغیر هستند، مقیاس گذاری به منظور آوردن تمام ویژگی‌ها به سطح بزرگی یکسان انجام می‌شود. 
محیط سیستم آزمایشی ویندوز ۱۰ سیستم‌عامل است و محیط عملیاتی نرم‌افزار Spyder، محیط توسعه پایتون علمی است که بخشی از پلتفرم Anaconda است. کتابخانه‌های مورد استفاده عبارتند از: کرمپی، پاندا، متپلوتیب، اسکیس دی و آموزش ندیده. 
</div>   
<br/>
<div dir="rtl">
الگوریتم های مورد استفاده در این آزمایش در بخش زیر توضیح داده شده‌اند.
</div> 
<br/>
<div dir="rtl">  
C. آزمایش 
</div>
<div dir="rtl">    
رگرسیون منطقی یکی از محبوب‌ترین الگوریتم های طبقه‌بندی در یادگیری ماشین است. مدل رگرسیون لجستیک رابطه بین پیش‌بینی‌کننده‌هایی را توصیف می‌کند که می‌توانند مداوم، دودویی و مطلق باشند. متغیر وابسته می‌تواند دوتایی باشد. براساس برخی از عوامل پیش‌بینی، ما پیش‌بینی می‌کنیم که آیا چیزی اتفاق خواهد افتاد یا خیر. ما احتمال تعلق به هر دسته را برای یک مجموعه پیش‌بینی‌کننده معین برآورد می‌کنیم. 
</div>
<br/>  
<div dir="rtl">    
نایو بیز یکی از الگوریتم های یادگیری تحت نظارت است که در آن هیچ وابستگی بین ویژگی‌ها وجود ندارد. اساس کار بر قضیه بیز استوار است. بسته به نوع توزیع، الگوریتم‌های زیر وجود دارند: توزیع گاوسی، توزیع چند جمله‌ای، توزیع برنولی. در این تحقیق، توزیع برنولی برای تشخیص معاملات کلاهبرداری استفاده می‌شود. 
</div>
<br/>
<div dir="rtl">    
جنگل تصادفی الگوریتمی است که می‌تواند هم در مسائل طبقه‌بندی و هم در مسائل رگرسیون مورد استفاده قرار گیرد. آن شامل بسیاری از درخت‌های تصمیم‌گیری است. این الگوریتم زمانی نتایج بهتری می‌دهد که تعداد درختان بیشتری در جنگل وجود داشته باشد و مانع از تناسب بیش از حد مدل شود. هر درخت تصمیم‌گیری در جنگل نتایجی می‌دهد. این نتایج با هم ادغام می‌شوند تا پیش‌بینی دقیق‌تر و پایدارتری به دست آید. 
</div>
<br/>
<div dir="rtl">
شبکه عصبی مصنوعی چند لایه پرسپترون پیش‌خور است که از حداقل ۳ لایه گره تشکیل شده‌است: لایه ورودی، لایه پنهان و لایه خروجی. هر گره از تابع فعالسازی استفاده می‌کند. تابع فعالسازی مجموع وزنی ورودی‌ها را محاسبه می‌کند و اریبی اضافه می‌کند. این به ما این امکان را می‌دهد که تصمیم بگیریم کدام نورون باید حذف شود و در اتصالات خارجی در نظر گرفته نشود. 
<div/>
<br/>
<div dir="rtl">
ANN مورد استفاده در این آزمایش شامل ۴ لایه مخفی به ترتیب با ۵۰، ۳۰، ۳۰ و ۵۰ واحد در هر لایه مخفی، با تابع فعال‌سازی رابو بود. نشان‌داده شده‌است که شبکه‌های عمیق‌تر نتایج بهتری نسبت به شبکه‌های با تعداد لایه‌های کم‌تر به دست می‌آورند [‏ ۲۰ ]‏. با دنبال کردن این تجربه، ما با تعداد کمتری از لایه‌ها شروع به افزایش تدریجی آن‌ها به منظور رسیدن به نتایج قابل‌قبول کردیم. بنابراین، بهترین پارامترهای بیش از حد براساس تحقیقات جامع انتخاب شدند. افزایش بیشتر شبکه باعث زمان محاسباتی بیشتر می‌شود و نتایج به ‌دست‌آمده تفاوت چندانی با معماری انتخاب‌شده ندارد. بهینه‌سازی وزن با بهینه‌سازی کننده مبتنی بر گرادیان تصادفی آدام انجام شد. 
</div>
  
